---
title: "Part 2b - Regression Analysis for Number of Issue"
author: "Magtms"
date: '2022-06-14'
output: html_document
---

```{r Regression - Relationship btwn number of issue & features}
# To find the relationship between number of issue vs all features

# Use grouping and inner join to find the number of project and number of issue per month [2016 to 2021]
project1 <- data2016 %>%
  group_by(month = lubridate::floor_date(c.created.date, "month")) %>%
  summarize(issue = length(ID))

project2 <- data2016 %>%
  group_by(month = lubridate::floor_date(c.created.date, "month")) %>%
  summarize(project = length(unique(Project)))

project <- project1 %>% 
  inner_join(project2, by = c("month" = "month"))


# Run the regression of number of project to number of issue per month
project <- as.data.frame (unclass(project), stringsAsFactors = TRUE)
str(project)

model = lm(issue ~ project, data = project)
summary(model)

plot(model)
res = residuals(model)
shapiro.test(res)

ggplot(project, aes(project, issue)) + 
  geom_point()

## The model above is the best regression for number of isse after trial of 
## [1] Closed data before the new function 
## [2] closed data after the new function 
## [3] Trial different feature combination 
## [4] With number of project

## The model from regression analysis is GOOD, reasons:
## 1. R-square is high, the model is valid enough to prove the correlation
## 2. Since the relationship is robust, there is enough evidence for the impact to number of issue


```
