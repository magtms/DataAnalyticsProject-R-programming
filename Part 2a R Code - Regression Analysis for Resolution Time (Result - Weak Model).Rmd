---
title: "Part 2.1 - Regression analysis for Resolution Time. Result: Weak Model"
author: "Magtms"
date: '2022-06-14'
output: html_document
---

```{r Regression - Relationship btwn resolution time & features}
# Run regression with dummy for [1] Priority & [2] Issue type with resolution time
# Check if there is relationship between [1] Priority & [2] Issue type to resolution time
# And see if there is any difference after new function launched on Dec 2019

# Based on the data set without "NA" in resolution date
# As we want to see the results of processing days hence data without resolution date (unclosed item) is not included.

# Unclass and factoring the data
closed2016 <- as.data.frame (unclass(closed2016), stringsAsFactors = TRUE)
str(closed2016)

# One-Hot Encoding: Create dummy for priority and issue type (after factoring)
contrasts(closed2016$Priority)
contrasts(closed2016$IssueType)
contrasts(closed2016$Country)

# Run regression for closed data since 2016
model = lm(processing.day ~ Priority +IssueType + Country + systemA + systemB + systemC + all.systemD,
           data = closed2016)
summary(model)
vif(model)      

plot(model)
res = residuals(model)
shapiro.test(res)
# VIF is close to 1 = minimal multicollinearity between features
# Residual check failed: sample size must be between 3 and 5000
# Adjusted R2 of this model is weak (0.1135)

## The model above is the best regression for processings day after trial of 
## [1] Closed data before the new function 
## [2] closed data after the new function 
## [3] Remove feature Country 
## [4] remove feature issue type etc. 

## This regression analysis failed, reasons:
## 1. R2 is too low, the model is not valid enough to prove the correlation
## 2. Since the relationship is not robust, there is no enough evidence for the impact to processing days

```